jQuery(document).ready((function(e){console.log("script: booking.js");let t=1*window.innerHeight;document.documentElement.style.setProperty("--vh",`${t}px`),window.addEventListener("resize",(()=>{let e=1*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`)}));let n=document.getElementById("date__picker");function i(e,t){window.location.href=function(e,t,n){if(e.includes("?")){if(e.includes(t)){let i=e.search(t),o=e.indexOf("&",i);-1==o&&(o=e.length);let s=e.substring(i,o);return e.replace(s,t+"="+n)}return e+"&"+t+"="+n}return e+"?"+t+"="+n}(window.location.href,e,t)}function o(e){const t=window.location.search;return new URLSearchParams(t).get(e)}function s(e,t){if(!e)throw new Error("setInnerText(): Es wurde kein Element "+e+" definiert!");e.innerText=t}function r(e){return e?e.innerText:null}function a(e){if(null==e)return!1;const t=new Date(e);let n=t.getDate();1===n.toString().length&&(n="0"+n);let i=t.getMonth();switch(i){case 0:i="Januar";break;case 1:i="Februar";break;case 2:i="März";break;case 3:i="April";break;case 4:i="Mai";break;case 5:i="Juni";break;case 6:i="Juli";break;case 7:i="August";break;case 8:i="September";break;case 9:i="Oktober";break;case 10:i="November";break;case 11:i="Dezember"}return n+". "+i+" "+t.getFullYear()}n?(n=MCDatepicker.create({el:"#date__picker",bodyType:"inline",closeOnBlur:!0,minDate:new Date,customOkBTN:"OK",customClearBTN:"Löschen",customCancelBTN:"Abbruch",dateFormat:"DD.MM.YYYY",customWeekDays:["So","Mo","Di","Mi","Do","Fr","Sa"],customMonths:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],firstWeekday:1}),n.onOpen((()=>{document.querySelector("#date__picker").parentElement.classList.add("--active")})),n.onClose((()=>{null==n.getFullDate()&&document.querySelector("#date__picker").parentElement.classList.remove("--active")}))):n=!1;class u{constructor(){this.productIdPHP=parseInt(document.getElementById("js-productId").innerText),this.productTitlePHP=document.getElementById("js-productTitle").innerText,this.productCategoryPHP=document.getElementById("js-productCategory").innerText,this.productGroupPHP=document.getElementById("js-productGroup").innerText,this.productPricePHP=parseInt(document.getElementById("js-productPrice").innerText),this.productPrice=this.productPricePHP,this.productName=document.getElementById("product__name").innerText,console.log(this.productIdPHP,this.productTitlePHP,this.productCategoryPHP,this.productPrice),this.validations={KursKINDER:[{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[40,"Max. 40 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],isNumber:[!0,"Es sind nur Ziffern zulässig."]},{isRequired:[!1,""],minLength:[10,"Deine Nachricht muss mindesten 10 Zeichen lang sein."],maxLength:[500,"Deine Nachricht darf maximal 500 Zeichen lang sein."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Dieses Feld muss ausgefüllt sein."],isEmail:[!0,"Bitte gib ein gültiges Format an."]},{isRequired:[!1,""],isNumber:[!0,"Es sind nur Ziffern zulässig."]}],KursERWACHSENE:[{isRequired:[!1,""],minLength:[10,"Deine Nachricht muss mindesten 10 Zeichen lang sein."],maxLength:[500,"Deine Nachricht darf maximal 500 Zeichen lang sein."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Dieses Feld muss ausgefüllt sein."],isEmail:[!0,"Bitte gib ein gültiges Format an."]},{isRequired:[!1,""],isNumber:[!0,"Es sind nur Ziffern zulässig."]}],Workshop:[{isRequired:[!1,""],minLength:[10,"Deine Nachricht muss mindesten 10 Zeichen lang sein."],maxLength:[500,"Deine Nachricht darf maximal 500 Zeichen lang sein."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Dieses Feld muss ausgefüllt sein."],isEmail:[!0,"Bitte gib ein gültiges Format an."]},{isRequired:[!1,""],isNumber:[!0,"Es sind nur Ziffern zulässig."]}],Geburtstag:[{isRequired:[!0,"Dieses Feld muss ausgefüllt sein."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[40,"Max. 40 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],isNumber:[!0,"Es sind nur Ziffern zulässig."]},{isRequired:[!1,""],minLength:[10,"Deine Nachricht muss mindesten 10 Zeichen lang sein."],maxLength:[500,"Deine Nachricht darf maximal 500 Zeichen lang sein."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],isEmail:[!0,"Bitte gib ein gültiges Format an."]},{isRequired:[!1,""],isNumber:[!0,"Es sind nur Ziffern zulässig."]}],Kunstevent:[{isRequired:[!0,"Dieses Feld muss ausgefüllt sein."]},{isRequired:[!0,"Dieses Feld muss ausgefüllt sein."]},{isRequired:[!0,"Dieses Feld muss ausgefüllt sein."]},{isRequired:[!1,""],minLength:[10,"Deine Nachricht muss mindesten 10 Zeichen lang sein."],maxLength:[500,"Deine Nachricht darf maximal 500 Zeichen lang sein."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],isEmail:[!0,"Bitte gib ein gültiges Format an."]},{isRequired:[!1,""],isNumber:[!0,"Es sind nur Ziffern zulässig."]}],Ferienprogramm:[{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[40,"Max. 40 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],isNumber:[!0,"Es sind nur Ziffern zulässig."]},{isRequired:[!1,""],minLength:[10,"Deine Nachricht muss mindesten 10 Zeichen lang sein."],maxLength:[500,"Deine Nachricht darf maximal 500 Zeichen lang sein."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Feld muss ausgefüllt sein."],minLength:[2,"Mind. 2 Zeichen benötigt."],maxLength:[20,"Max. 20 Zeichen erlaubt."]},{isRequired:[!0,"Dieses Feld muss ausgefüllt sein."],isEmail:[!0,"Bitte gib ein gültiges Format an."]},{isRequired:[!1,""],isNumber:[!0,"Es sind nur Ziffern zulässig."]}]},this.bookingInfos=JSON.parse(localStorage.getItem("booking_infos")),this.currentBookingStep=parseInt(o("step")),this.furthestBookingStep=localStorage.getItem("furthestBookingStep"),this.productGroup=document.getElementById("product__group"),this.productCat=o("product_cat"),this.bookingExtras=null,this.formElement=document.getElementById("info__form"),this.colorName="",this.navLinks=document.querySelectorAll(".process__nav span"),this.prevButton=document.querySelector(".step__prev"),this.nextButton=document.querySelector(".step__next"),this.dateRadios=document.querySelectorAll("input[type='radio']"),this.peopleInput=document.querySelector("select[name='peoplecount']"),this.bookingDuration=localStorage.getItem("booking_duration"),this.declareBookingSteps(),this.declareEventListener(),this.declareColorName(),0===this.currentBookingStep&&this.runBookingStep0(),1===this.currentBookingStep&&this.runBookingStep1(),2===this.currentBookingStep&&this.runBookingStep2(),3===this.currentBookingStep&&this.runBookingStep3(),4===this.currentBookingStep&&this.runBookingStep4(),5===this.currentBookingStep&&("true"===localStorage.getItem("is_booked")&&(window.location.href="https://www.atelier-delatron.de"),this.runBookingStep5()),this.setAllOnLoad()}declareBookingSteps(){this.setCurrentBookingStep(this.currentBookingStep),this.currentBookingStep>this.furthestBookingStep&&this.setFurthestBookingStep(this.currentBookingStep),this.productGroup&&(this.productGroup=this.productGroup.innerText.toUpperCase())}declareEventListener(){e(".info__mobile-header").click((t=>{e(t.currentTarget).parent().toggleClass("--opened"),e(t.currentTarget).parent().find(".info__content").slideToggle(300)})),1!==this.currentBookingStep&&this.prevButton.addEventListener("click",(()=>{this.safeAll(),"Geburtstag"===this.productCat?i("step",this.currentBookingStep-1):4===this.currentBookingStep?i("step",this.currentBookingStep-2):i("step",this.currentBookingStep-1)})),this.nextButton.addEventListener("click",(()=>{this.safeAll()&&(5!==this.currentBookingStep?"Geburtstag"===this.productCat?i("step",this.currentBookingStep+1):2===this.currentBookingStep?i("step",this.currentBookingStep+2):i("step",this.currentBookingStep+1):this.submitBooking())})),this.dateRadios.forEach((e=>{e.addEventListener("click",(()=>{this.updateInfoDate(),document.getElementById("date__error").classList.add("--hidden")}))})),"Kunstevent"===this.productCat&&this.peopleInput&&this.peopleInput.addEventListener("change",(e=>{this.setKunsteventTooltips()}));const t=document.querySelectorAll(".quit__button");t&&t.forEach((e=>{e.addEventListener("click",(e=>{let t;t="A"===e.target.tagName?e.target.dataset.productLink:e.target.parentElement.dataset.productLink,confirm("Willst du die Buchung wirklich verlassen? Deine Angegebene Daten werden dadurch gelöscht.")&&(window.location=t)}))}))}declareColorName(){"Kurs"===this.productCat?"KINDER"===this.productGroup?this.colorName="blue":"ERWACHSENE"===this.productGroup&&(this.colorName="purple"):"Workshop"===this.productCat?this.colorName="red":"Geburtstag"===this.productCat?this.colorName="green":"Kunstevent"===this.productCat?this.colorName="pink":"Ferienprogramm"===this.productCat&&(this.colorName="yellow")}declareExtras(){"Geburtstag"===this.productCat?this.bookingExtras=[{id:1,title:"Nur Workshop",description:"30 Minuten Feierlichkeiten abwählen",price:-25,duration:-.5,selected:!1}]:console.log("no extras declared"),null!==this.bookingExtras&&localStorage.setItem("booking_extras",JSON.stringify(this.bookingExtras))}setAllOnLoad(){this.setDateOnLoad(),this.setSummaryOnLoad(),this.setNavOnLoad(),this.updateDuration(),"Geburtstag"!==this.productCat&&"Kunstevent"!==this.productCat||(this.setPricingOnLoad(),this.furthestBookingStep>=3&&this.setInfoTable()),2===this.currentBookingStep&&this.setInfoOnLoad(),5===this.currentBookingStep&&this.setProofOnLoad()}setDateOnLoad(){let e=o("date_selected")||JSON.parse(localStorage.getItem("booking_dates"));if(null!=e&&"object"==typeof e&&(e=e[0]),n&&null!=e){const t=new Date(e);n.setFullDate(t)}else this.dateRadios.forEach((t=>{if(t.value===e&&(t.checked=!0,null===localStorage.getItem("booking_dates"))){let e=[t.value],n=[t.dataset.time];void 0!==t.dataset.dateTwo&&(e.push(t.dataset.dateTwo),n.push(t.dataset.timeTwo)),localStorage.setItem("booking_dates",JSON.stringify(e)),localStorage.setItem("booking_times",JSON.stringify(n))}}))}setInfoOnLoad(){this.bookingForm.setValues(this.bookingInfos),"Kunstevent"===this.productCat&&this.setPeoplecount(this.bookingInfos.duration,this.bookingInfos.peoplecount)}setSummaryOnLoad(){const e=JSON.parse(localStorage.getItem("booking_dates")),t=JSON.parse(localStorage.getItem("booking_times"));if(e){const i=document.getElementById("summary__date"),o=e[0];let s;if(null!=t&&(s=t[0]),n(i,o,s),e.length>1){const i=document.getElementById("summary__date2"),o=e[1];let s;null!=t&&(s=t[1]),n(i,o,s)}}function n(e,t,n=!1){let i=a(t);n&&(i+=" || "+n),s(e,i)}}setProofOnLoad(){function e(e,t,n){const o=document.getElementById(e);if(!o)throw new Error(`Das Angegeben Element existiert nicht: ${e}`);o.querySelector(".item__value").innerText=""!==t?t:"–",o.querySelector(".edit__button").addEventListener("click",(()=>{i("step",n)}))}document.querySelectorAll(".proof__item");const t=JSON.parse(localStorage.getItem("booking_infos"));e("proof--date",a(JSON.parse(localStorage.getItem("booking_dates"))[0]),1),e("proof--fullname",t.firstname+" "+t.lastname,2),e("proof--email",t.email,2),e("proof--phone",t.phone,2),e("proof--message",t.message,2),"KINDER"===this.productGroup&&(e("proof--childname",t.childname,2),e("proof--childage",t.childage+" Jahre",2)),"Geburtstag"!==this.productCat&&"Kunstevent"!==this.productCat||e("proof--peoplecount",t.peoplecount+" Personen",2),"Kunstevent"===this.productCat&&(e("proof--eventtype",t.eventtype,2),e("proof--duration",t.duration+" Stunden",2)),"Ferienprogramm"===this.productCat&&(e("proof--childname",t.childname,2),e("proof--childage",t.childage+" Jahre",2));document.querySelector(".wpcf7").querySelectorAll("input[type='hidden'].wpcf7-form-control");function n(e,t){const n=document.querySelector('input[name="'+e+'"]');n?(console.log(n),n.value=t):console.log('cf7SetValue() - The input element "'+e+'" doesn`t exist.')}n("product-id",this.productIdPHP),n("product-title",this.productTitlePHP),n("product-category",this.productCategoryPHP),this.productGroupPHP&&n("product-group"," für "+this.productGroupPHP),n("product-price",this.productPricePHP+"€"),n("customer-firstname",t.firstname),n("customer-lastname",t.lastname),n("customer-email",t.email),n("customer-phone",t.phone),n("customer-message",t.message),"KINDER"===this.productGroup&&(n("customer-childname",t.childname),n("customer-childage"," | "+t.childage+" Jahre")),"Kurs"===this.productCat&&(n("course-startdate","ab "+a(JSON.parse(localStorage.getItem("booking_dates"))[0])),n("course-time",r(document.getElementById("course__time"))),n("course-day",r(document.getElementById("course__day"))+"s")),"Workshop"!==this.productCat&&"Ferienprogramm"!==this.productCat||(n("workshop-date",r(document.getElementById("summary__date"))),n("workshop-date-2",r(document.getElementById("summary__date2")))),"Geburtstag"===this.productCat&&(n("customer-peoplecount",t.peoplecount+" Teilnehmer"),n("birthday-date",r(document.getElementById("summary__date")))),"Kunstevent"===this.productCat&&(n("customer-peoplecount",t.peoplecount+" Teilnehmer"),n("event-date",r(document.getElementById("summary__date"))),n("event-duration",t.duration+" Stunden"),n("event-type",t.eventtype))}setPricingOnLoad(){if(this.bookingExtras){const e=document.querySelectorAll(".price__extra");this.bookingExtras.forEach((t=>{!0===t.selected&&e[t.id-1].classList.add("--active")}))}}setNavOnLoad(){for(let e=0;e<this.furthestBookingStep;e++)this.navLinks[e].classList.add("--visited");this.currentBookingStep>0&&this.navLinks[this.currentBookingStep-1].classList.add("--active"),this.navLinks.forEach(((e,t)=>{e.classList.contains("--visited")&&!e.classList.contains("--active")&&e.addEventListener("click",(()=>{this.safeAll(),i("step",t+1)}))}))}setPeoplecount(e,t=!1){let n="disabled";"3.5"===e?n=[3,4,5,6,7,8,9,10]:"4.5"===e&&(n=[5,6,7,8,9,10]);const i=this.peopleInput,o=i.value;i.innerHTML="";let s=document.createElement("option");s.value="","disabled"===n?(this.peopleInput.disabled=!0,s.innerText="Dauer wählen...",i.append(s)):(i.disabled=!1,s.innerText="Auswählen...",i.append(s),n.forEach((t=>{let n=document.createElement("option");n.value=t,n.innerText=t+" Teilnehmer ",n.dataset.pricePerson=this.calcKunsteventPrice(e,t)[1],i.append(n),t==o&&(i.value=o)})),3!=o&&4!=o||(this.bookingInfos.peoplecount="undefined",localStorage.setItem("booking_infos",JSON.stringify(this.bookingInfos)))),o>=5&&this.setKunsteventTooltips(),!1!==t&&(i.value=t)}setKunsteventTooltips(){const e=parseInt(this.peopleInput[this.peopleInput.selectedIndex].dataset.pricePerson);this.peopleInput.querySelectorAll("option").forEach(((t,n)=>{if(""!=t.value){const i=parseInt(this.peopleInput[n].dataset.pricePerson)-e;t.value!=this.peopleInput[this.peopleInput.selectedIndex].value?t.innerText=i>0?t.value+" Teilnehmer ( +"+i+"€ p.P. )":t.value+" Teilnehmer ( "+i+"€ p.P. )":t.innerText=t.value+" Teilnehmer"}}))}setInfoTable(){document.querySelectorAll(".info__table__row").forEach((e=>{const t=e.querySelector(".value"),n=this.bookingInfos.peoplecount;if(e.classList.contains("info__table__row--geburtstag-price-person")){const e=JSON.parse(localStorage.getItem("geburtstag_infos")).price_person,o=e*n;this.productPrice=o,void 0!==n&&"undefined"!=n&&""!=n?(i(t,n+" Teilnehmer x "+e+"€"),s(t,o+"€")):(i(t,!1),s(t,"Teilnehmerzahl wählen..."))}if(e.classList.contains("info__table__row--geburtstag-total")){const e=JSON.parse(localStorage.getItem("geburtstag_infos")),i=e.price_base+e.price_person*n;this.productPrice=i,s(t,null!=n&&"undefined"!=n&&""!=n?i+"€":"Konfiguration wählen...")}if(e.classList.contains("info__table__row--kunstevent-person-count")&&(console.log(n),s(t,"undefined"!==n?`${n} Teilnehmer`:"Teilnehmerzahl wählen...")),e.classList.contains("info__table__row--kunstevent-person-price"))if("undefined"!==n){const[e]=this.calcKunsteventPrice(this.bookingDuration,n);s(t,`${e/n}€`)}else s(t,"Teilnehmerzahl wählen...");if(e.classList.contains("info__table__row--kunstevent-total")){let[e,o]=this.calcKunsteventPrice(this.bookingDuration,n);this.productPrice=e,null!=n&&"undefined"!=n&&""!=n?(i(t,n+" Teilnehmer x "+o+"€"),s(t,e+"€")):(i(t,!1),s(t,"Konfiguration wählen..."))}function i(e,t){!1!==t?(e.parentElement.querySelector(".tooltip").classList.add("--visible"),e.parentElement.querySelector(".tooltip span").innerText=t):e.parentElement.querySelector(".tooltip").classList.remove("--visible")}}))}updateDuration(){if("Kunstevent"===this.productCat){let e=this.bookingDuration;this.extrasIsSelected()&&this.bookingExtras.forEach((t=>{t.selected&&(e+=t.duration)})),document.querySelector(".summary__duration .value").innerHTML=e>0?e+" Stunden":"Dauer wählen..."}}safeAll(){return 1===this.currentBookingStep?this.safeDate():2===this.currentBookingStep?this.safeInfo():3!==this.currentBookingStep||this.safeExtras()}safeExtras(){document.querySelectorAll(".extras__list input");return localStorage.setItem("booking_extras",JSON.stringify(this.bookingExtras)),!0}safeDate(){if(n){const e=new Date;e.setDate(e.getDate()+7);const t=new Date(n.getYear(),n.getMonth(),n.getDate());return isNaN(t)?(document.getElementById("date__error").innerText="Bitte wähle einen Termin aus...",document.getElementById("date__error").classList.remove("--hidden"),!1):t<e?(document.getElementById("date__error").innerText="Der Termin muss mind. 1 Woche in der Zukunft liegen.",document.getElementById("date__error").classList.remove("--hidden"),!1):(document.getElementById("date__error").classList.add("--hidden"),localStorage.setItem("booking_dates",JSON.stringify([n.getFullDate()])),!0)}if(!1!==this.getSelectedDate()){let e=[this.getSelectedDate()];return"Workshop"===this.productCat&&this.getSelectedDate(2)&&e.push(this.getSelectedDate(2)),localStorage.setItem("booking_dates",JSON.stringify(e)),!0}return document.getElementById("date__error").classList.remove("--hidden"),!1}safeInfo(){return!!this.bookingForm.validateForm()&&(localStorage.setItem("booking_infos",JSON.stringify(this.bookingForm.getValues())),!0)}setCurrentBookingStep(e=this.currentBookingStep){localStorage.setItem("currentBookingStep",e),this.currentBookingStep=e}setFurthestBookingStep(e=this.furthestBookingStep){localStorage.setItem("furthestBookingStep",e),this.furthestBookingStep=e}updateInfoDate(){const e=document.getElementById("summary__date"),t=a(this.getSelectedDate()),n=this.getSelectedTime();"Workshop"!==this.productCat?e.innerText=t:e.innerText=t+" || "+n;const i=document.getElementById("summary__date2"),o=a(this.getSelectedDate(2)),s=this.getSelectedTime(2);i&&("Workshop"!==this.productCat?i.innerText=o:i.innerText=o+" || "+s)}calcKunsteventPrice(e,t){const n=JSON.parse(localStorage.getItem("kunstevent_infos"));let i=(n.prices_hour[t-3]*e+(n.price_food+n.price_material)*t)/t;return i=Math.round(i),[i*t,i]}getSelectedDate(e=1){let t;return this.dateRadios.forEach((n=>{1==n.checked&&(t=1===e?n.value:n.dataset.dateTwo)})),void 0!==t&&t}getSelectedTime(e=1){let t;return document.querySelectorAll("input[type='radio']").forEach((n=>{1==n.checked&&(t=1===e?n.dataset.time:n.dataset.timeTwo)})),void 0!==t&&t}extrasIsSelected(){if(this.bookingExtras){this.bookingExtras=JSON.parse(this.bookingExtras);let e=!1;return this.bookingExtras.forEach((t=>{!0===t.selected&&(e=!0)})),e}return!1}runBookingStep0(){this.resetLocalstorage(),this.safePrices(),this.declareExtras(),this.safeBookingData(),i("step","1")}runBookingStep1(){if(!this.bookingDuration){const e=document.getElementById("duration");localStorage.setItem("booking_duration",e.innerText),this.bookingDuration=e.innerText}}runBookingStep2(){const e="Kurs"===this.productCat?this.productCat+this.productGroup:this.productCat;this.bookingForm=new Form(this.formElement,this.validations[e]);const t={};this.formElement.querySelectorAll("input, select, textarea").forEach((e=>{t[e.name]=""})),"{}"===localStorage.getItem("booking_infos")&&localStorage.setItem("booking_infos",JSON.stringify(t)),this.peopleInput&&this.peopleInput.addEventListener("change",(e=>{this.bookingInfos&&(""==e.target.value?this.bookingInfos.peoplecount="undefined":this.bookingInfos.peoplecount=e.target.value,localStorage.setItem("booking_infos",JSON.stringify(this.bookingInfos)),this.setInfoTable())}));const n=document.querySelector("select[name='duration']");n&&n.addEventListener("change",(e=>{localStorage.setItem("booking_duration",e.target.value),this.bookingDuration=e.target.value,"Kunstevent"===this.productCat&&this.setPeoplecount(e.target.value),"Kunstevent"===this.productCat&&""===e.target.value&&(this.bookingInfos.peoplecount="undefined",localStorage.setItem("booking_infos",JSON.stringify(this.bookingInfos))),this.setInfoTable()}))}runBookingStep3(){}runBookingStep4(){this.waitForElm(".wpcf7-response-output").then((e=>{window.location.href=`https://www.atelier-delatron.shop/buchung-bestaetigt?color=${this.colorName}&booking_product=${encodeURIComponent(this.productName).replace("%20","+")}&booking_category=${this.productCat}&booking_value=${this.productPrice}`}))}runBookingStep5(){this.waitForElm(".wpcf7-response-output").then((e=>{window.location.href="https://www.atelier-delatron.shop/buchung-bestaetigt?color="+this.colorName}))}waitForElm(e){return new Promise((t=>{if("Vielen Dank für Buchung, Du wirst nun weitergeleitet."===document.querySelector(e).innerText)return t(document.querySelector(e));const n=new MutationObserver((i=>{"Vielen Dank für Buchung, Du wirst nun weitergeleitet."===document.querySelector(e).innerText&&(t(document.querySelector(e)),n.disconnect())}));n.observe(document.body,{childList:!0,subtree:!0})}))}safeBookingData(){localStorage.setItem("booking_infos",JSON.stringify({}));let e=[];document.querySelectorAll(".kunstevent_price_hour").forEach((t=>{e.push(parseInt(t.innerText))}));const t={};return t.prices_hour=e,t.price_food=parseInt(document.getElementById("kunstevent_price_food").innerText),t.price_material=parseInt(document.getElementById("kunstevent_price_material").innerText),localStorage.setItem("kunstevent_infos",JSON.stringify(t)),!0}safePrices(){const e={price_base:parseInt(document.getElementById("price__base").innerText),price_hour:parseInt(document.getElementById("price__hour").innerText),price_person:parseInt(document.getElementById("price__person").innerText)};return localStorage.setItem("geburtstag_infos",JSON.stringify(e)),!0}setCheckboxError(e,t){!1===t?(e.parentElement.classList.remove("--error"),e.parentElement.querySelector(".checkbox__error").innerText=""):(e.parentElement.classList.add("--error"),e.parentElement.querySelector(".checkbox__error").innerText=t)}submitBooking(){let e=!0;document.querySelectorAll("input#checkbox1[type='checkbox']").forEach((t=>{t.required&&!t.checked?(e=!1,this.setCheckboxError(t,"Du musst die Bedingung akzeptieren.")):this.setCheckboxError(t,!1)})),e&&this.sendEmail()&&(this.runBookingStep4(),localStorage.setItem("is_booked",!0),document.getElementById("submit__button").click())}sendEmail(){const e=this.bookingInfos.childname,t=this.bookingInfos.childage,n=""!==this.bookingInfos.message?this.bookingInfos.message:"k. A.",i={firstname:this.bookingInfos.firstname,lastname:this.bookingInfos.lastname,phone:this.bookingInfos.phone,email:this.bookingInfos.email};let o={};if("Kurs"===this.productCat&&(o={data:{course:{price:this.productPrice,name:this.productName,startdate:document.getElementById("summary__date").innerText,time:document.getElementById("course__time").innerText,day:document.getElementById("course__day").innerText,session_count:document.getElementById("course__session__count").innerText,session_duration:document.getElementById("course__session__duration").innerText},customer:{childname:e,childage:t,message:n}}},"KINDER"===this.productGroup?sibSendEmail("booking_course_kinder",i,o):sibSendEmail("booking_course_erwachsene",i,o)),"Workshop"===this.productCat){const t=document.getElementById("summary__date").innerText;let s=document.getElementById("summary__date2");s=s?s.innerText:"",o={data:{workshop:{price:this.productPrice,name:this.productName,termin:t,termin2:s},customer:{childname:e,message:n}}},sibSendEmail("booking_workshop",i,o)}if("Geburtstag"===this.productCat){const t=document.getElementById("summary__date").innerText;let s;s=this.extrasIsSelected()?getExtrasAsString():"k. A.",o={data:{birthday:{price:this.productPrice,name:this.productName,termin:t,people_count:this.bookingInfos.peoplecount,extras:s},customer:{childname:e,message:n}}},sibSendEmail("request_birthday",i,o)}if("Kunstevent"===this.productCat){const e=document.getElementById("summary__date").innerText;o={data:{event:{price:this.productPrice,name:this.productName,termin:e,people_count:this.bookingInfos.peoplecount,occasion:this.bookingInfos.eventtype,duration:this.bookingInfos.duration},customer:{message:n}}},sibSendEmail("request_event",i,o)}if("Ferienprogramm"===this.productCat){const s=document.getElementById("summary__date").innerText;let r=document.getElementById("summary__date2");r=r?r.innerText:"",o={data:{workshop:{price:this.productPrice,name:this.productName,termin:s,termin2:r},customer:{childname:e,childage:t,message:n}}},sibSendEmail("booking_ferienprogramm",i,o)}return!0}resetLocalstorage(){localStorage.removeItem("booking_infos"),localStorage.removeItem("booking_extras"),localStorage.removeItem("booking_dates"),localStorage.removeItem("booking_times"),localStorage.removeItem("booking_duration"),localStorage.removeItem("is_booked")}}if(document.querySelector(".book")){new u}}));
//# sourceMappingURL=booking.js.map