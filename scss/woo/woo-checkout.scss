/*------------------------------------*/
/* Woocommerce: Checkout */
/*------------------------------------*/
body.woocommerce-checkout .woocommerce {
	// TODO: Make this general (2/2)
	.right {
		@include flex('column');
		justify-content: start;
		align-items: stretch;
		gap: 60px;

		@media only screen and (max-width: $desktop) {
			gap: 45px;
		}
	}

	/*------------------------------------*/
	/* Coupon */
	/*------------------------------------*/
	.checkout__discount {
		&:has(.checkout_coupon) {
			.woocommerce-form-coupon-toggle {
				display: none;
			}
		}

		&:has(.woocommerce-form-login-toggle) {
			h4 {
				padding-top: 50px !important;
			}
		}

		.checkout__coupon {
			display: flex !important;
			margin-bottom: var(--section-gap);
			flex-direction: column;
		}

		// Permanently show coupon field
		.checkout_coupon {
			display: block !important;
		}

		// Form toggle field
		.woocommerce-form-login-toggle {
			order: -2;
			margin-top: 0;
			margin-bottom: 0;

			.woocommerce-info {
				@include box;
				margin: 0 0 10px;
				padding-top: 22px;
				padding-bottom: 22px;
			}

			.showlogin {
				color: $accent;
				font-weight: 800;
				text-align: right;
			}
		}

		// Login form
		.woocommerce-form-login {
			@include box;
			order: -1;
			margin-top: 0;
			margin-bottom: 10px;
			@include flex('column');
			align-items: stretch;
			gap: 20px;

			p:first-of-type {
				@include text;
				@extend .--size-small;
			}

			.clear {
				display: none;
			}

			.form-row-first,
			.form-row-last {
				@include input;

				label {
					@include label;
				}

				> span {
					width: 100%;
				}
			}

			.form-row--filled {
				padding: 0;
				@include flex('column');
				gap: 25px;

				.woocommerce-form__label-for-checkbox {
					@include checkbox;

					input {
						height: 0;
						transform: translateY(3px);
					}
				}

				button {
					@extend .--color-main;
					width: 100%;
				}
			}
		}

		.woocommerce-form-login + .woocommerce-notices-wrapper + form {
			margin-top: 50px;
		}
	}

	/*------------------------------------*/
	/* Customer Inputs */
	/*------------------------------------*/
	#customer_details {
		@include flex('column');
		align-items: stretch;
		gap: var(--section-gap);

		// Create account (logged out)
		.woocommerce-account-fields {
			margin-top: -30px;

			.create-account .form-row {
				&::after {
					content: unset;
				}

				label {
					@include label;
				}

				.woocommerce-password-strength {
					border: solid 2px $main;
					border-radius: 8px;
					margin-top: 15px;
					padding: 8px 18px;
					font-size: 14px;

					&.short,
					&.bad {
						border-color: $red;
						color: $red;
					}

					&.good {
						border-color: orange;
						color: orange;
					}

					&.strong {
						border-color: $accent;
						color: $accent;
					}

					&:empty {
						display: none;
					}
				}

				.woocommerce-password-hint {
					padding-top: 15px;
					display: inline-block;
					@include text;
					@extend .--size-small;
				}
			}
		}
	}

	/*------------------------------------*/
	/* Summary / Review */
	/*------------------------------------*/
	.right {
		// Warenkorb
		.accordeon {
			.accordeon__item {
				background-color: white;
				border-color: transparent;
				@include drop-shadow-shop;

				.accordeon__content {
					padding-top: 5px;

					.cart__item {
						@include flex('row');
						justify-content: flex-start;
						align-items: center;
						column-gap: 20px;
						pointer-events: none;

						&:not(:last-child) {
							padding-bottom: 15px;
							margin-bottom: 15px;
						}

						.product__image {
							height: 50px;
							width: 50px;
							min-width: 50px;
							border-radius: 8px;
							border: solid 1px $linegray;
						}

						.product__infos {
							.product__name__price {
								align-items: baseline;

								span,
								a,
								* {
									@include fluid-type(15px, 16px);
									font-weight: 400;
									font-family: $main-font;
									color: $main;
									text-decoration: none;
									text-transform: none;
								}

								.product__name,
								.product__subtotal {
									display: block;

									.variation {
										display: none;
									}
								}
							}
						}
					}
				}
			}
		}

		.shop_table tfoot tr.shipping__total {
			@include dashed-border($linegray, bottom);

			th,
			td {
				padding-bottom: $table-padding;
			}
		}

		// Gutschein
		.checkout__coupon {
			.woocommerce-error {
				display: block;
				margin-bottom: 15px !important;
			}
		}

		// Versand
		.shipping__methods {
			.woocommerce-shipping-methods {
				@include element-select-list;
			}
		}

		// Bestell√ºbersicht
		.cart__calculation {
			.tr--border-top:first-of-type {
				background: none;
			}
		}

		// Bezahlung
		.woocommerce-checkout-payment {
			display: none;
		}

		// AGB Checkbox
		.wc-gzd-checkbox-placeholder-legal {
			margin: -20px 0;

			.checkbox-legal {
				padding: 0 !important;

				.required {
					display: none;
				}
			}
		}

		// Paypal
		.ppc-button-wrapper {
			z-index: 1;
			order: 10;

			&:empty,
			&:not(:has(#ppc-button-ppcp-gateway .component-frame)) {
				display: none;
			}
		}

		/* ---- Payment Button Container ----*/
		.wc-gzd-order-submit {
			margin-top: -15px;

			.form-row {
				padding: 0;
			}

			&:not(:has(#ppc-button-ppcp-gateway .component-frame)) {
				display: none;
			}
		}

		/*------------------------------------*/
		/* Payment loader */
		/*------------------------------------*/
		.paypal-loader {
			width: 100%;
			@include flex('column');
			align-items: center;
			gap: 14px;
			order: 11;

			img {
				height: 21px;
				margin-bottom: 10px;
			}

			div {
				width: 100%;
				height: 45px;
				background-color: #f3f3f3;
				border: solid 1px $linegray;
				border-radius: 50px;
				@include loading;

				&:nth-of-type(2)::after {
					animation-delay: 150ms;
				}

				&:nth-of-type(3)::after {
					animation-delay: 300ms;
				}

				&:nth-of-type(4)::after {
					animation-delay: 450ms;
				}

				&:nth-of-type(5)::after {
					animation-delay: 600ms;
				}
			}
		}

		// Hide payment loader when Paypal button is loaded
		&:has(#ppc-button-ppcp-gateway .component-frame) {
			.paypal-loader {
				display: none;
			}
		}
	}

	/*------------------------------------*/
	/* Responsive */
	/*------------------------------------*/
	@include bp-lower($desktop) {
		.checkout__discount {
			form.woocommerce-form-login {
				.form-row--filled {
					flex-direction: column;
					align-items: flex-start;
					gap: 20px;
				}
			}
		}

		.accordeon__item {
			.accordeon__header {
				padding: 22px 20px;
			}
		}
	}
}
